# Описание разработанного протокола взаимодействия

Микросервис, разработанный на основе FastAPI, предоставляет два основных эндпоинта для работы с курсами валют. Ниже приведено описание каждого эндпоинта.

API национального банка: [https://www.nbrb.by/apihelp/exrates](https://www.nbrb.by/apihelp/exrates)

## 1. GET /check

**Описание:**
Первый эндпоинт по условию. Получает курсы валют банка по указанной дате. Отображает сообщение о статусе выполнения.

**Запрос:**
- `date` (str, обязательный) - Дата в формате YYYY-MM-DD.

**Пример запроса:**
```
http://127.0.0.1:8000/check?date=2024-01-10
```

**Ответ:**
Формат: класс Response библиотеки FastAPI. В заголовок добавлен CRC32 от тела ответа. Payload состоит из следующих полей:
- `date` (str) - Дата запроса.
- `status` (str) - Статус запроса (например, "Success").
- `message` (str) - Сообщение о результате запроса.
- `data` (array) - Массив объектов класса Rate (описание класса можно найти в документации API банка).

**Пример ответа JSON:**
```json
{
  "date": "2024-06-13",
  "status": "Success",
  "message": "Exchange rates loaded successfully.",
  "data": [
    {
      "Cur_ID": 440,
      "Date": "2024-01-10T00:00:00",
      "Cur_Abbreviation": "AUD",
      "Cur_Scale": 1, "Cur_Name":
      "Австралийский доллар",
      "Cur_OfficialRate": 2.1412
    },
      ...
  ]
}
```

## 2. GET /get_rate

**Описание:**
Эндпоинт возвращает курсы валют по указанной дате и по указанному коду валют. Дополнительно выводит разницу между курсами данной даты и предыдущей.

**Запрос:**
- `date` (str, обязательный) - Дата в формате YYYY-MM-DD.
- `code` (str, обязательный) - Код валюты.

**Пример запроса:**
```
http://127.0.0.1:8000/get_rate?date=2023-01-10&code=456
```

**Ответ:**
Формат ответа: класс Response библиотеки FastAPI. В заголовок добавлен CRC32 от тела ответа. Payload содержит в себе объект класса Rate.

**Пример ответа JSON:**
```json
{
  "Cur_ID": 456,
  "Date": "2023-01-10T00:00:00",
  "Cur_Abbreviation": "RUB",
  "Cur_Scale": 100,
  "Cur_Name":
  "Российских рублей",
  "Cur_OfficialRate": 3.835,
  "change": 0.0234
}
```

# Инструкция по установке

## Шаг 1: Клонирование репозитория

```bash
git clone https://github.com/A7exG0/ExchangeRatesMS
cd ExchangeRatesMS
```

## Шаг 2: Создание виртуального окружения

```bash
python -m venv env
```

Активируйте виртуальное окружение:

- На Windows:
  ```bash
  .\env\Scripts\activate
  ```

- На macOS/Linux:
  ```bash
  source env/bin/activate
  ```

## Шаг 3: Установка зависимостей

```bash
pip install fastapi uvicorn requests
```

## Шаг 4: Запуск приложения

```bash
uvicorn app.main:app --reload
```

## Шаг 5: Тестирование работы

Перейдите в браузер и введите следующие URL для проверки:

- Получение курса валют на определенную дату:
  ```
  http://127.0.0.1:8000/check?date=2024-06-13
  ```

- Получение курса конкретной валюты на определенную дату:
  ```
  http://127.0.0.1:8000/get_rate?date=2024-06-13&code=456
  ```
